---
u---
title: "Class Reference"
author: "Derek Willis"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
print("Hello puppy!")
```

## Introduction

Consider this a personal guide to the commands and functions you will learn. In general, when you come across an R command or function that you want to remember, put it in here along with a description of what it does and when you'd use it.

### Find repository

On Github, Repository -\> View in Finder

### How to set the working directory

The command to set a working directory is setwd(). For example:

```{r}
setwd("~/code/data_journalism_2023_spring")
```

Or, open the folder you're working from in the R directory on the right (or click on the three dots to use the Finder app) - that's your working directory - and click the settings wheel and hit "Set as working directory."

### First, install and load the tidyverse

```{r}
install.packages("tidyverse")
library(tidyverse)
```

```{r}
library(tidyverse)
```

### How to read in a CSV file from the Internet

```{r}
wes_moore_contributions <- read_csv("https://raw.githubusercontent.com/stephenneukam/CNS_Annapolis/main/Campaign_finance/Moore_ContributionsList.csv")
```

You use the `n()` function to count rows and get an overview of the data, like so:

```{r}
umd_courses |> 
  group_by(title) |> 
  summarize(count = n())
```

Use variables, and how to make new datasets

If you don't want to type in 2 everytime you use it, you can set it equal to "number" - meaning that whenever you type "number" it'll know that you mean 2.

```{r}
number <- 2
```

### Open certain data

Note: The function is stupid and refuses to look into subfolders. So tell it to look in the folder where the file is, not anywhere else.

```{r}
what_you_want_the_thing_youre_saying_to_be_called' <- read_csv/rds/etc("file_name")
```

```{r}
umd_courses <- read_rds("umd_courses.rds")
```

### The pipe operator

"Do this thing next"

CMD + P

```{r}
|> 
```

#### Sorting

Think of a deck of cards, if you're told to group them by group, you'd seperate by hearts, clubs, aces, jacks, etc. **Same thing in R.**

```{r}
group_by()
```

### Useful Functions

Get a list of unique values in your dataset

```{r}
dataset_name |> 
  group_by(column_you_want_to_see_an_overview_of) |> 
  summarize(count = n())
```

Get a list of all the columns with mean, median, and quartiles

```{r}
summary(%)
```

Get a quick list of all the columns

```{r}
col_names (%)
```

Filter data using the filter() function. BUT make sure to do ==, otherwise it'll turn all the columns into, in this case, journalism.

```{r}
filter(department=="Journalism")
```

R loves to be a pain in the ass and show you only case-matched results. Here's how to tell it to look for it in every case:

```{r}
filter(str_detect(gender, "(?i)F"))
```

Count the number of rows

```{r}
  summarize(count = n())
```

Change a column's name

```{r}
colnames(your_file_or_variable_name) <- c("what_you_want_it_to_say_instead")
```

In this example, the first column's name is changed to "what_you_want_it_to_say_instead"

### Boolean Operators

-   Is exactly: ==

-   Is not: !=

-   Contains: str_detect("keyword")

-   Is greater than: \>

-   Is less than: \<

-   Is greater than or equal to: \>=

-   Everything except this: -variable

-   And: (&) (,)

-   Or: \|

-   Begins with: \^

If you want to look up two things in one filter

```{r}
earthquakes |> 
   filter(str_detect(place, "alaska") | str_detect(place, "Alaska"))
```

To find the mean

```{r}
earthquakes |> 
  filter(str_detect(type, "earthquake")) |> 
  summarize(mean_depth = mean(depth))
```

Lubridate (in tidyverse) syntax

```{r}
what_you_want_the_column_to_called=lubridate_function(existing_column)
```

Make a new column based on whether something is a certain thing

```{r}
library(tidyverse)
library(lubridate)
library(janitor)

earthquakes <- read_csv('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.csv')

earthquakes |> 
  mutate(
    ##what you want the column to be called 
    state 
    = case_when(
        mag>3 ~ "serious",
        .default = "not serious"
      )
    ## makes a NEW column with whether it's serious or not
  )
```

Pick only certain columns

```{r}
earthquakes |> 
  select(mag)
```

Remove something from your library/environment

```{r}
rm(get_rid_of_this)
```

Check if there are any non-dates in a column after you've loaded the lubridate library using the women_shot_in_2020 dataframe with dates in a ymd arrangement (quiet=TRUE just tells R to shut the hell up about its stupid warnings):

```{r}
testing_shot_women <- women_shot_in_2020 %>%
  filter(!is.Date(ymd(date, quiet = TRUE)))
```

**Combining data**

`bind_rows` helps to combine data. It'll combine any two datasets with the same structure together - identical column names and data structured the same way.

```{r}
# bind_rows with list, from pre-lab 6
county_voters_combined <- bind_rows(list(county_voters_2016, county_voters_2018, county_voters_2020, county_voters_2022))
View(county_voters_combined)
```

It gets more complicated when you have two similar, but not identically structured tables (think different column names). We use `join` for these cases. It has several values:

`left_join` - takes the table on the left and adds only matching data from the right table

`right_join` - takes the table on the right and adds only matching data form the left table

`inner_join` - returns only matches

`full-join` - combine everything, regardless of if there are matches

```{r}
maryland_population |> 
  left_join(county_voters_2020, join_by("COUNTY"))
```

This would add only data from the rows with the same label as `maryland_population` thanks to the `join_by` function. It tells R what to look at when trying to join two datasets. (By default, R joins by county here, there's nothing else it could join by so it works fine here. Anything else wouldn't work because `maryland_population` doesn't have the same columns.)

If there are two columns that show the same thing but don't have the same name, you can tell R what's equivalent in the `join_by` function.

```{r}
maryland_population_with_voters_and_demographics <- maryland_population_with_voters |> 
  left_join(maryland_demographics, join_by(COUNTY == NAME))
```
